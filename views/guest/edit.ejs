<%- layout("layouts/boilerplate.ejs") %>
<body>
    
    <div class="col-6 offset-3 mb-3">
        <h3>Edit Guest Info</h3>
    <form action="/guest/<%=guest._id%>?_method=PATCH" method="POST" class="needs-validation" novalidate>
        <div class="mt-3">
            <label for="" class="form-label">Name:</label>
            <input type="text"  class="form-control" name="guest[name]" required value="<%=guest.name%>">
            
        </div>
        <div class="mt-3">
            <label for="" class="form-label">Number:</label>
            <input type="number" class="form-control" name="guest[number]" required value="<%=guest.number%>" id="number" >
            <div class="invalid-feedback"> start with 7 8 or 9 & 10 digit number</div>
        </div>
        <div class="mt-3">
            <label for="" class="form-label">Address:</label>
            <textarea name="guest[address]" id="" class="form-control" required ><%=guest.address%></textarea>
            <div class="invalid-feedback">Address is required</div>
        </div>
        <div class="mt-3">
            <label for="" class="form-label">Purpose:   </label>
                <select name="guest[purpose]" class="form-control" id="" required >
                    <option value="<%=guest.purpose%>"><%=guest.purpose%></option>
                    <option value="Business">Business</option>
                    <option value="Personal">Personal</option>
                    <option value="Tourist">Tourist</option>
                </select>
         
        </div>
        <div class="mt-3">
            <label for="" class="form-label">Select Stay Dates</label>
            <input type="text" name="guest[dates]" required id="selectedDates" >
            <div class="invalid-feedback" id="invalid-udate">Date is required</div>
        </div>
        <div class="mt-3">
            <label for="" class="form-label">Email:</label>
            <input type="email" class="form-control" required placeholder="Enter your Email" name="guest[email]" value="<%=guest.email%>">
            <div class="invalid-feedback">Enter a valid Email</div>
        </div>
        <div class="mt-3">
            <label for="" class="form-label"> ID Proof:</label>
            <select name="guest[idProof]" class="form-control" id="" required>
                <option value="<%=guest.idProof%>"><%=guest.idProof%></option>
                <option value="Aadhar Card">Aadhar Card</option>
                <option value="Pan Card">Pan Card</option>
                <option value="Passport">Passport</option>
            </select>
        </div>
        <div class="mt-3">
          
            <button class="btn btn-secondary" type="submit"> Edit </button>
          
        </div>
    </form>
    </div>
    <script>
         document.addEventListener('DOMContentLoaded', function() {
        const defaultDates = <%-JSON.stringify(guest.dates)%>;
        
        const today = new Date();
        const maxDate = new Date(today);
        maxDate.setDate(today.getDate() + 60); // Adding 60 days

        // Format the date as YYYY-MM-DD for flatpickr
        const maxDateFormatted = maxDate.toISOString().split('T')[0];
        const todayFormatted = today.toISOString().split('T')[0];
        console.log(defaultDates);
                flatpickr("#selectedDates", {
                    mode: "multiple",
                    dateFormat: "Y-m-d",
                    defaultDate: defaultDates,
                    minDate: todayFormatted,
                    maxDate: maxDateFormatted,
                      
                });
        });
    </script>
</body>